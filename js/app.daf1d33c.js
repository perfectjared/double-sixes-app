(function(t){function e(e){for(var a,o,r=e[0],l=e[1],c=e[2],h=0,u=[];h<r.length;h++)o=r[h],Object.prototype.hasOwnProperty.call(s,o)&&s[o]&&u.push(s[o][0]),s[o]=0;for(a in l)Object.prototype.hasOwnProperty.call(l,a)&&(t[a]=l[a]);d&&d(e);while(u.length)u.shift()();return n.push.apply(n,c||[]),i()}function i(){for(var t,e=0;e<n.length;e++){for(var i=n[e],a=!0,o=1;o<i.length;o++){var l=i[o];0!==s[l]&&(a=!1)}a&&(n.splice(e--,1),t=r(r.s=i[0]))}return t}var a={},s={app:0},n=[];function o(t){return r.p+"js/"+({}[t]||t)+"."+{"chunk-2d0d5fe0":"6c5771de","chunk-2d229bd2":"c942d1f4"}[t]+".js"}function r(e){if(a[e])return a[e].exports;var i=a[e]={i:e,l:!1,exports:{}};return t[e].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.e=function(t){var e=[],i=s[t];if(0!==i)if(i)e.push(i[2]);else{var a=new Promise((function(e,a){i=s[t]=[e,a]}));e.push(i[2]=a);var n,l=document.createElement("script");l.charset="utf-8",l.timeout=120,r.nc&&l.setAttribute("nonce",r.nc),l.src=o(t);var c=new Error;n=function(e){l.onerror=l.onload=null,clearTimeout(h);var i=s[t];if(0!==i){if(i){var a=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;c.message="Loading chunk "+t+" failed.\n("+a+": "+n+")",c.name="ChunkLoadError",c.type=a,c.request=n,i[1](c)}s[t]=void 0}};var h=setTimeout((function(){n({type:"timeout",target:l})}),12e4);l.onerror=l.onload=n,document.head.appendChild(l)}return Promise.all(e)},r.m=t,r.c=a,r.d=function(t,e,i){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)r.d(i,a,function(e){return t[e]}.bind(null,a));return i},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/double-sixes-app/",r.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],c=l.push.bind(l);l.push=e,l=l.slice();for(var h=0;h<l.length;h++)e(l[h]);var d=c;n.push([0,"chunk-vendors"]),i()})({0:function(t,e,i){t.exports=i("56d7")},"0a1c":function(t,e,i){},1:function(t,e){},2:function(t,e){},"223e":function(t,e,i){"use strict";i("6bd7")},"294f":function(t,e,i){"use strict";i("0a1c")},3:function(t,e){},"4cce":function(t,e,i){"use strict";i("e95d")},"56d7":function(t,e,i){"use strict";i.r(e),i.d(e,"objectEventBus",(function(){return Jt})),i.d(e,"controlEventBus",(function(){return Ut})),i.d(e,"fileEventBus",(function(){return Yt}));var a=i("2b0e"),s=function(){var t=this,e=t._self._c;return e("div",[e("appToolbar"),e("appSidebar"),e("appImageCanvas")],1)},n=[],o=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"toolbar"}},[e("b-button-group",{attrs:{vertical:"",size:"lg","aria-role":"toolbar"}},[e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.select,title:"Cursor (v)"},on:{click:t.selectClick}},[e("svg",{staticClass:"bi bi-cursor",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M14.082 2.182a.5.5 0 0 1 .103.557L8.528 15.467a.5.5 0 0 1-.917-.007L5.57 10.694.803 8.652a.5.5 0 0 1-.006-.916l12.728-5.657a.5.5 0 0 1 .556.103zM2.25 8.184l3.897 1.67a.5.5 0 0 1 .262.263l1.67 3.897L12.743 3.52 2.25 8.184z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.pan,title:"Pan (hold space)"},on:{click:t.panClick}},[e("svg",{staticClass:"bi bi-arrows-move",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M7.646.146a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 1.707V5.5a.5.5 0 0 1-1 0V1.707L6.354 2.854a.5.5 0 1 1-.708-.708l2-2zM8 10a.5.5 0 0 1 .5.5v3.793l1.146-1.147a.5.5 0 0 1 .708.708l-2 2a.5.5 0 0 1-.708 0l-2-2a.5.5 0 0 1 .708-.708L7.5 14.293V10.5A.5.5 0 0 1 8 10zM.146 8.354a.5.5 0 0 1 0-.708l2-2a.5.5 0 1 1 .708.708L1.707 7.5H5.5a.5.5 0 0 1 0 1H1.707l1.147 1.146a.5.5 0 0 1-.708.708l-2-2zM10 8a.5.5 0 0 1 .5-.5h3.793l-1.147-1.146a.5.5 0 0 1 .708-.708l2 2a.5.5 0 0 1 0 .708l-2 2a.5.5 0 0 1-.708-.708L14.293 8.5H10.5A.5.5 0 0 1 10 8z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.center,title:"Center (c)"},on:{click:t.centerClick}},[e("svg",{staticClass:"bi bi-arrows-fullscreen",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M5.828 10.172a.5.5 0 0 0-.707 0l-4.096 4.096V11.5a.5.5 0 0 0-1 0v3.975a.5.5 0 0 0 .5.5H4.5a.5.5 0 0 0 0-1H1.732l4.096-4.096a.5.5 0 0 0 0-.707zm4.344 0a.5.5 0 0 1 .707 0l4.096 4.096V11.5a.5.5 0 1 1 1 0v3.975a.5.5 0 0 1-.5.5H11.5a.5.5 0 0 1 0-1h2.768l-4.096-4.096a.5.5 0 0 1 0-.707zm0-4.344a.5.5 0 0 0 .707 0l4.096-4.096V4.5a.5.5 0 1 0 1 0V.525a.5.5 0 0 0-.5-.5H11.5a.5.5 0 0 0 0 1h2.768l-4.096 4.096a.5.5 0 0 0 0 .707zm-4.344 0a.5.5 0 0 1-.707 0L1.025 1.732V4.5a.5.5 0 0 1-1 0V.525a.5.5 0 0 1 .5-.5H4.5a.5.5 0 0 1 0 1H1.732l4.096 4.096a.5.5 0 0 1 0 .707z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.rect,title:"Rectangle (r)"},on:{click:t.rectClick}},[e("svg",{staticClass:"bi bi-square",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M14 1H2a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H2z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.ellipse,title:"Ellipse (e)"},on:{click:t.ellipseClick}},[e("svg",{staticClass:"bi bi-circle",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M8 15A7 7 0 1 0 8 1a7 7 0 0 0 0 14zm0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",title:"Polygon (p)",disabled:""},on:{click:t.polygonClick}},[e("svg",{staticClass:"bi bi-pentagon",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M8 1.288l-6.842 5.56L3.733 15h8.534l2.575-8.153L8 1.288zM16 6.5L8 0 0 6.5 3 16h10l3-9.5z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.line,title:"Sequential connection (s)"},on:{click:t.lineClick}},[e("svg",{staticClass:"bi bi-arrow-up-right",attrs:{width:"1em",height:"1em",viewBox:"0 0 16 16",fill:"currentColor",xmlns:"http://www.w3.org/2000/svg"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M14 2.5a.5.5 0 0 0-.5-.5h-6a.5.5 0 0 0 0 1h4.793L2.146 13.146a.5.5 0 0 0 .708.708L13 3.707V8.5a.5.5 0 0 0 1 0v-6z"}})])]),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{variant:"light",pressed:t.jump,title:"Jumping connection (j)"},on:{click:t.jumpClick}},[e("svg",{staticClass:"bi bi-arrow-90deg-right",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{"fill-rule":"evenodd",d:"M14.854 4.854a.5.5 0 0 0 0-.708l-4-4a.5.5 0 0 0-.708.708L13.293 4H3.5A2.5 2.5 0 0 0 1 6.5v8a.5.5 0 0 0 1 0v-8A1.5 1.5 0 0 1 3.5 5h9.793l-3.147 3.146a.5.5 0 0 0 .708.708l4-4z"}})])])],1)],1)},r=[],l={data(){return{select:!0,panSelect:!1,panToggle:!1,center:!1,rect:!1,ellipse:!1,line:!1,jump:!1,top:document.documentElement.clientHeight/2}},directives:{},methods:{clear:function(){this.select=!1,this.panSelect=!1,this.rect=!1,this.ellipse=!1,this.line=!1,this.jump=!1,Ut.imagePanRelease()},selectClick:function(){Ut.drawSelect(),Ut.imagePanRelease(),this.clear(),this.select=!0},panClick:function(){Ut.imagePanPress(),this.clear(),this.panSelect=!0},centerClick:function(){Ut.imagePlace()},rectClick:function(){Ut.drawRect(),Ut.imagePanRelease(),this.clear(),this.rect=!0},ellipseClick:function(){Ut.drawEllipse(),Ut.imagePanRelease(),this.clear(),this.ellipse=!0},polygonClick:function(){},lineClick:function(){Ut.drawLine(),Ut.imagePanRelease()},jumpClick:function(){Ut.drawJump(),Ut.imagePanRelease()}},computed:{pan:function(){return this.panSelect||this.panToggle}},mounted(){Ut.$on("drawSelect",()=>{this.clear(),this.select=!0}),Ut.$on("imagePanPress",()=>{this.panToggle=!0}),Ut.$on("imagePanRelease",()=>{this.panToggle=!1}),Ut.$on("drawRect",()=>{this.clear(),this.rect=!0}),Ut.$on("drawEllipse",()=>{this.clear(),this.ellipse=!0}),Ut.$on("drawLine",()=>{this.clear(),this.line=!0}),Ut.$on("drawJump",()=>{this.clear(),this.jump=!0})},created(){}},c=l,h=(i("4cce"),i("2877")),d=Object(h["a"])(c,o,r,!1,null,"fb5ff980",null),u=d.exports,p=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"sidebar"}},[e("div",{attrs:{id:"buttons"}},[e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.left",modifiers:{hover:!0,left:!0}},{name:"b-toggle",rawName:"v-b-toggle.bsidebar",modifiers:{bsidebar:!0}}],attrs:{name:"sidebarButton",id:"eyeButton",pill:"",variant:"light",size:"md",title:"Sidebar"}},[e("svg",{staticClass:"bi bi-layout-sidebar-reverse",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M16 3a2 2 0 0 0-2-2H2a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3zm-5-1v12H2a1 1 0 0 1-1-1V3a1 1 0 0 1 1-1h9zm1 0h2a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1h-2V2z"}})])]),e("br"),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{name:"boardButton",id:"boardButton",pill:"",variant:"light",size:"md",title:"Upload board image"},on:{click:t.buttonBoard}},[e("svg",{staticClass:"bi bi-image",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M6.002 5.5a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0z"}}),e("path",{attrs:{d:"M2.002 1a2 2 0 0 0-2 2v10a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V3a2 2 0 0 0-2-2h-12zm12 1a1 1 0 0 1 1 1v6.5l-3.777-1.947a.5.5 0 0 0-.577.093l-3.71 3.71-2.66-1.772a.5.5 0 0 0-.63.062L1.002 12V3a1 1 0 0 1 1-1h12z"}})]),e("image-load",{attrs:{id:"boardUpload"}})],1),e("br"),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}},{name:"b-toggle",rawName:"v-b-toggle.asidebar",modifiers:{asidebar:!0}}],attrs:{name:"analysisButton",id:"analysisButton",pill:"",variant:"light",title:"Analysis",size:"md"},on:{click:t.analysisToggle}},[e("svg",{staticClass:"bi bi-clipboard-data",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M4 11a1 1 0 1 1 2 0v1a1 1 0 1 1-2 0v-1zm6-4a1 1 0 1 1 2 0v5a1 1 0 1 1-2 0V7zM7 9a1 1 0 0 1 2 0v3a1 1 0 1 1-2 0V9z"}}),e("path",{attrs:{d:"M4 1.5H3a2 2 0 0 0-2 2V14a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V3.5a2 2 0 0 0-2-2h-1v1h1a1 1 0 0 1 1 1V14a1 1 0 0 1-1 1H3a1 1 0 0 1-1-1V3.5a1 1 0 0 1 1-1h1v-1z"}}),e("path",{attrs:{d:"M9.5 1a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-1a.5.5 0 0 1 .5-.5h3zm-3-1A1.5 1.5 0 0 0 5 1.5v1A1.5 1.5 0 0 0 6.5 4h3A1.5 1.5 0 0 0 11 2.5v-1A1.5 1.5 0 0 0 9.5 0h-3z"}})])]),e("br"),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{name:"jsonButton",id:"downloadButton",pill:"",variant:"light",size:"md",title:"Download JSON"},on:{click:t.download}},[e("svg",{staticClass:"bi bi-file-earmark-arrow-down",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M8.5 6.5a.5.5 0 0 0-1 0v3.793L6.354 9.146a.5.5 0 1 0-.708.708l2 2a.5.5 0 0 0 .708 0l2-2a.5.5 0 0 0-.708-.708L8.5 10.293V6.5z"}}),e("path",{attrs:{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"}})])]),e("br"),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}}],attrs:{name:"upButton",id:"uploadButton",pill:"",variant:"light",size:"md",title:"Upload JSON"},on:{click:t.buttonJson}},[e("svg",{staticClass:"bi bi-file-earmark-arrow-up",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M8.5 11.5a.5.5 0 0 1-1 0V7.707L6.354 8.854a.5.5 0 1 1-.708-.708l2-2a.5.5 0 0 1 .708 0l2 2a.5.5 0 0 1-.708.708L8.5 7.707V11.5z"}}),e("path",{attrs:{d:"M14 14V4.5L9.5 0H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2zM9.5 3A1.5 1.5 0 0 0 11 4.5h2V14a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1h5.5v2z"}})])]),e("input",{staticStyle:{display:"none"},attrs:{id:"jsonUpload",type:"file",accept:".json"}}),e("br"),e("b-button",{directives:[{name:"b-tooltip",rawName:"v-b-tooltip.hover.right",modifiers:{hover:!0,right:!0}},{name:"b-toggle",rawName:"v-b-toggle.dbSidebar",modifiers:{dbSidebar:!0}}],attrs:{name:"dbButton",id:"dbButton",pill:"",variant:"light",size:"md",title:"Database"},on:{click:t.databaseToggle}},[e("svg",{staticClass:"bi bi-wifi",attrs:{xmlns:"http://www.w3.org/2000/svg",width:"2em",height:"2em",fill:"currentColor",viewBox:"0 0 16 16"}},[e("path",{attrs:{d:"M15.384 6.115a.485.485 0 0 0-.047-.736A12.444 12.444 0 0 0 8 3C5.259 3 2.723 3.882.663 5.379a.485.485 0 0 0-.048.736.518.518 0 0 0 .668.05A11.448 11.448 0 0 1 8 4c2.507 0 4.827.802 6.716 2.164.205.148.49.13.668-.049z"}}),e("path",{attrs:{d:"M13.229 8.271a.482.482 0 0 0-.063-.745A9.455 9.455 0 0 0 8 6c-1.905 0-3.68.56-5.166 1.526a.48.48 0 0 0-.063.745.525.525 0 0 0 .652.065A8.46 8.46 0 0 1 8 7a8.46 8.46 0 0 1 4.576 1.336c.206.132.48.108.653-.065zm-2.183 2.183c.226-.226.185-.605-.1-.75A6.473 6.473 0 0 0 8 9c-1.06 0-2.062.254-2.946.704-.285.145-.326.524-.1.75l.015.015c.16.16.407.19.611.09A5.478 5.478 0 0 1 8 10c.868 0 1.69.201 2.42.56.203.1.45.07.61-.091l.016-.015zM9.06 12.44c.196-.196.198-.52-.04-.66A1.99 1.99 0 0 0 8 11.5a1.99 1.99 0 0 0-1.02.28c-.238.14-.236.464-.04.66l.706.706a.5.5 0 0 0 .707 0l.707-.707z"}})])])],1),e("b-sidebar",{attrs:{name:"bsidebar",id:"bsidebar",width:t.width,title:t.title,right:"",shadow:""},model:{value:t.toggled,callback:function(e){t.toggled=e},expression:"toggled"}},[e("object-manager",{attrs:{id:"object-manager",selected:t.selected}})],1),e("analysis"),e("database")],1)},g=[],b=function(){var t=this,e=t._self._c;return e("div",[t.imgLoaded?t._e():e("div",{attrs:{id:"imageload"},on:{click:t.selectImage}},[e("input",{ref:"imgLoad",attrs:{type:"file",accept:".png"},on:{input:t.storeImage}})])])},m=[],f={data:function(){return{img:{img:new Image,name:"",type:null},imgLoaded:!1}},methods:{selectImage:function(){this.$refs.imgLoad.click()},storeImage:function(){let t=this.$refs.imgLoad,e=t.files,i=new Image;if(e&&e[0]){let t=new FileReader;t.fileName=e[0].name,t.onload=t=>{i.src=t.target.result,this.img.name=t.target.fileName},t.onloadend=()=>{this.img.img=i,this.imgLoaded=!0,this.img.type=e[0].type,this.img.file=e[0],this.submitImage()},t.readAsDataURL(e[0])}},submitImage:function(){Yt.imageLoaded(this.img),Jt.createBoard(this.img)}}},v=f,w=(i("d50a"),Object(h["a"])(v,b,m,!1,null,"7eec34d9",null)),C=w.exports,y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"px-3 py-2",attrs:{id:"objectManager"}},[t.selected[0]?e("div",[t.selected[0].space?e("space-list",{key:t.selected[0].space.id,attrs:{space:t.selected[0].space,id:t.selected[0].space.id,embed:!1}}):t._e(),t.selected[0].connection?e("connection-list",{key:t.selected[0].connection.id,attrs:{connection:t.selected[0].connection,id:t.selected[0].connection.id,embed:!1}}):t._e()],1):t.analysisToggle?e("div"):t.topBoard?e("div",[e("board-list",{key:t.topBoard.id,attrs:{board:t.topBoard,id:t.topBoard.id}})],1):t._e()])},x=[],S=(i("14d9"),i("21a6")),j=i("7a94"),O=i("8aa5");i("66ce"),i("588e");const k={apiKey:"AIzaSyC2pxabpZMk1Nc3C7H0_v3AyTa6ZVMi4os",authDomain:"double-sixes-testing.firebaseapp.com",projectId:"double-sixes-testing",storageBucket:"double-sixes-testing.appspot.com",messagingSenderId:"60295337404",appId:"1:60295337404:web:9e4fa15760147e01f287b9"};O["initializeApp"](k);const T={db:O["database"](),store:O["storage"]()};var A=T;const B=A.db.ref(),z=A.store.ref();class _{getAll(){return B}async createThubmnail(t){return new Promise(e=>{let i={},a=new FileReader;a.onload=function(t){let a=t.target.result;j["fabric"].Image.fromURL(a,t=>{const a=128;let s=Math.min(a/t.width,a/t.height);t.filters.push(new j["fabric"].Image.filters.Resize({scaleX:s,scaleY:s})),t.applyFilters(),i=t._element.toDataURL(),e(i)})},a.readAsDataURL(t.file)})}async imageUpload(t,e){return console.log("trying to upload ",e),new Promise((i,a)=>{let s={};s="string"==typeof t?z.child(e).putString(t,"data_url"):z.child(e).put(t.file),s.on("state_changed",t=>{const e=Math.ceil(t.bytesTransferred/t.totalBytes*100);console.log(e+"% uploaded")},t=>{console.log(t),a(t)},async()=>{const t=await s.snapshot.ref.getDownloadURL();console.log("uploaded to "+t),i(t)})})}async create(t,e){let i=await new Promise(e=>{this.createThubmnail(t).then(t=>{e(t)})});e.url=await new Promise(i=>{this.imageUpload(t,e.title).then(t=>{i(t)}).catch(t=>{})}),e.url_thumb=await new Promise(t=>{this.imageUpload(i,e.title+"_thumb").then(e=>{t(e)}).catch(t=>{})}),B.push(e).then(()=>{console.log("submitted",e.title," successfully: "),console.log(e)}).catch(t=>{console.log(t)})}update(t,e){return B.child(t).update(e)}delete(t){return B.child(t).remove()}deleteAll(){return B.remove()}}var E=new _,P=i("ade3");class ${constructor(t,e){Object(P["a"])(this,"fileName",""),Object(P["a"])(this,"image",[]),Object(P["a"])(this,"title",""),Object(P["a"])(this,"id",0),Object(P["a"])(this,"movementType",""),Object(P["a"])(this,"chanceMechanism",""),Object(P["a"])(this,"type",[]),Object(P["a"])(this,"spaces",{}),Object(P["a"])(this,"englishTitle",""),Object(P["a"])(this,"date",""),Object(P["a"])(this,"height",""),Object(P["a"])(this,"width",""),Object(P["a"])(this,"artist",""),Object(P["a"])(this,"publisher",""),Object(P["a"])(this,"theme",[]),Object(P["a"])(this,"material",null),Object(P["a"])(this,"otherMaterial",""),this.fileName=t,this.image=e}set fileName(t){this.fileName=t}set title(t){this.title=t}set image(t){this.image=t}set id(t){this.id=t}set dice(t){this.dice=t}set furidashi(t){this.furidashi=t}set agari(t){this.agari=t}set spaces(t){this.spaces=t}get fileName(){return this.fileName}get title(){return this.title}get id(){return this.id}get image(){return this.image}get spacesAmount(){return this.spaces.length}get spaces(){return this.spaces}trimTitle(t){return t.split(".").slice(0,-1).join(".")}spaceAt(t){return this.spaces[t]}addSpace(t){this.spaces.push(t)}removeSpace(t){this.spaces=this.spaces.splice(t,1)}clearSpaces(){this.spaces=[]}}var L=function(){var t=this,e=t._self._c;return e("div",[e("b-form",{attrs:{id:t.id.toString()}},[t.board?e("b-img",{attrs:{src:t.board.image.src,fluid:"",thumbnail:""}}):t._e(),e("p",[e("small",[e("em",[t._v(t._s(t.board.fileName))])])]),e("b-form-group",{staticClass:"mb-0",attrs:{label:"Publication Info","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-1",label:"Title","label-for":"input-1","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-1",size:"sm"},model:{value:t.board.title,callback:function(e){t.$set(t.board,"title",e)},expression:"board.title"}})],1),e("b-form-group",{attrs:{id:"input-group-2",label:"Title (Translated)","label-for":"input-2","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-2",size:"sm"},model:{value:t.board.englishTitle,callback:function(e){t.$set(t.board,"englishTitle",e)},expression:"board.englishTitle"}})],1),e("b-form-group",{attrs:{id:"input-group-7",label:"Date","label-for":"input-7",description:"YYYY/MM/DD","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-7",size:"sm"},model:{value:t.board.date,callback:function(e){t.$set(t.board,"date",e)},expression:"board.date"}})],1),e("b-form-group",{attrs:{id:"input-group-9",label:"Publisher","label-for":"input-9","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-9",size:"sm"},model:{value:t.board.publisher,callback:function(e){t.$set(t.board,"publisher",e)},expression:"board.publisher"}})],1),e("b-form-group",{attrs:{id:"input-group-12",label:"Artist","label-for":"input-12","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-12",size:"sm"},model:{value:t.board.artist,callback:function(e){t.$set(t.board,"artist",e)},expression:"board.artist"}})],1)],1),e("b-form-group",{staticClass:"mb-1",attrs:{label:"Design Info","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-3",label:"Theme","label-for":"input-3",description:"Comma separated","label-size":"sm"}},[e("b-form-tags",{attrs:{id:"input-3",separator:",",size:"sm"},model:{value:t.board.theme,callback:function(e){t.$set(t.board,"theme",e)},expression:"board.theme"}})],1),e("b-form-group",{attrs:{id:"input-group-13",label:"Movement Type","label-for":"input-13","label-size":"sm"}},[e("b-form-select",{attrs:{id:"input-13",size:"sm",options:t.boardOptions.movementType},model:{value:t.board.movementType,callback:function(e){t.$set(t.board,"movementType",e)},expression:"board.movementType"}})],1),e("b-form-group",{attrs:{id:"input-group-14",label:"Chance Mechanism","label-for":"input-14","label-size":"sm"}},[e("b-form-select",{attrs:{id:"input-14",size:"sm",options:t.boardOptions.chanceMechanism},model:{value:t.board.chanceMechanism,callback:function(e){t.$set(t.board,"chanceMechanism",e)},expression:"board.chanceMechanism"}})],1)],1),e("b-form-group",{staticClass:"mb-2",attrs:{label:"Material Info","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-5",label:"Height","label-for":"input-5",description:"cm","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-5",size:"sm"},model:{value:t.board.height,callback:function(e){t.$set(t.board,"height",e)},expression:"board.height"}})],1),e("b-form-group",{attrs:{id:"input-group-6",label:"Width","label-for":"input-6",description:"cm","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-6",size:"sm"},model:{value:t.board.width,callback:function(e){t.$set(t.board,"width",e)},expression:"board.width"}})],1),e("b-form-group",{attrs:{id:"input-group-10",label:"Material","label-for":"input-10","label-size":"sm"}},[e("b-form-select",{attrs:{id:"input-10",size:"sm",options:t.boardOptions.material},model:{value:t.board.material,callback:function(e){t.$set(t.board,"material",e)},expression:"board.material"}})],1),"other"==t.board.material?e("b-form-group",{attrs:{id:"input-group-11",label:"Other Material","label-for":"input-11","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-11",size:"sm"},model:{value:t.board.otherMaterial,callback:function(e){t.$set(t.board,"otherMaterial",e)},expression:"board.otherMaterial"}})],1):t._e()],1)],1)],1)},M=[],N={data(){return{boardOptions:{movementType:[{value:"roundabout",text:"回り / Roundabout"},{value:"jumping-roundabout",text:"飛び回り / Jumping Roundabout)"},{value:"jumping",text:"飛び / Jumping"},{value:"parted",text:"振分 / Parted"},{value:"hybrid",text:"Hybrid"}],material:[{value:"paper",text:"Paper"},{value:"cardboard",text:"Cardboard"},{value:"newsprint",text:"Newsprint"},{value:"chipboard",text:"Chipboard"},{value:"fabric",text:"Fabric"},{value:"plastic",text:"Plastic"},{value:"unknown",text:"Unknown"},{value:"other",text:"Other"}],chanceMechanism:[{value:"dice",text:"Dice"},{value:"cards",text:"Cards",disabled:!0},{value:"roulette",text:"Roulette"},{value:"spinner",text:"Spinner"},{value:"teetotem",text:"Teetotem"},{value:"electronic",text:"Electronic"}]}}},props:{board:Object,id:Number},mounted(){},created(){},computed:{},components:{},methods:{}},R=N,I=Object(h["a"])(R,L,M,!1,null,"09f40514",null),V=I.exports;class D{constructor(t){Object(P["a"])(this,"index",0),Object(P["a"])(this,"shape",{}),Object(P["a"])(this,"id",""),Object(P["a"])(this,"number",""),Object(P["a"])(this,"furidashi",!1),Object(P["a"])(this,"agari",!1),Object(P["a"])(this,"exact",!0),Object(P["a"])(this,"description",""),Object(P["a"])(this,"instructionText",""),Object(P["a"])(this,"instructionTranslation",""),Object(P["a"])(this,"otherText",""),Object(P["a"])(this,"otherTranslation",""),this.shape=t}get id(){return this.id}set id(t){this.id=t,this.shape.id=t}SetID(t){this.id=t,this.shape.id=t}}var H=function(){var t=this,e=t._self._c;return e("div",[e("b-form",{attrs:{id:t.id.toString()}},[e("b-form-group",{staticClass:"mb-0",attrs:{label:"Space Info","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-1",label:"Space #","label-for":"input-1","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-1",size:"sm"},model:{value:t.space.number,callback:function(e){t.$set(t.space,"number",e)},expression:"space.number"}})],1),e("b-form-checkbox",{attrs:{id:"checkbox-1",size:"sm"},on:{change:t.furidashi},model:{value:t.space.furidashi,callback:function(e){t.$set(t.space,"furidashi",e)},expression:"space.furidashi"}},[t._v("\n                振り出し / Start\n            ")]),e("b-form-checkbox",{attrs:{id:"checkbox-2",size:"sm"},on:{change:t.agari},model:{value:t.space.agari,callback:function(e){t.$set(t.space,"agari",e)},expression:"space.agari"}},[t._v("\n                上がり / End\n            ")]),t.space.agari?e("b-form-checkbox",{attrs:{id:"checkbox-3",size:"sm"},model:{value:t.space.exact,callback:function(e){t.$set(t.space,"exact",e)},expression:"space.exact"}},[t._v("\n                Exact roll needed for 上がり\n            ")]):t._e(),e("b-form-group",{attrs:{id:"input-group-3",label:"Description","label-for":"input-3","label-size":"sm"}},[e("b-form-textarea",{attrs:{id:"input-3",size:"sm",placeholder:"Description"},model:{value:t.space.description,callback:function(e){t.$set(t.space,"description",e)},expression:"space.description"}})],1)],1),e("b-form-group",{staticClass:"mb-0",attrs:{label:"Text","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-4",label:"Instruction Text","label-for":"input-4","label-size":"sm"}},[e("b-form-textarea",{attrs:{id:"input-4",size:"sm",placeholder:"Instruction Text"},model:{value:t.space.instructionText,callback:function(e){t.$set(t.space,"instructionText",e)},expression:"space.instructionText"}})],1),e("b-form-group",{attrs:{id:"input-group-5",label:"Instruction Translation","label-for":"input-5","label-size":"sm"}},[e("b-form-textarea",{attrs:{id:"input-5",size:"sm",placeholder:"Instruction Translation"},model:{value:t.space.instructionTranslation,callback:function(e){t.$set(t.space,"instructionTranslation",e)},expression:"space.instructionTranslation"}})],1),e("b-form-group",{attrs:{id:"input-group-6",label:"Other Text","label-for":"input-6","label-size":"sm"}},[e("b-form-textarea",{attrs:{id:"input-6",size:"sm",placeholder:"Other Text"},model:{value:t.space.otherText,callback:function(e){t.$set(t.space,"otherText",e)},expression:"space.otherText"}})],1),e("b-form-group",{attrs:{id:"input-group-4",label:"Other Translation","label-for":"input-4","label-size":"sm"}},[e("b-form-textarea",{attrs:{id:"input-4",size:"sm",placeholder:"Other Translation"},model:{value:t.space.otherTranslation,callback:function(e){t.$set(t.space,"otherTranslation",e)},expression:"space.otherTranslation"}})],1)],1)],1)],1)},J=[],U={data(){return{}},methods:{furidashi:function(t){t?(this.space.agari&&(this.space.agari=!1),this.space.shape.ChangeLabel("振り出し / Start")):this.space.agari?this.space.shape.ChangeLabel("上がり / End"):this.space.shape.ChangeLabel("")},agari:function(t){t?(this.space.furidashi&&(this.space.furidashi=!1),this.space.shape.ChangeLabel("上がり / End")):this.space.furidashi?this.space.shape.ChangeLabel("振り出し / Start"):this.space.shape.ChangeLabel("")}},props:{space:Object,id:Number,embed:Boolean}},Y=U,X=Object(h["a"])(Y,H,J,!1,null,"1590ba4e",null),q=X.exports;class W{constructor(t,e,i,a="sequential"){Object(P["a"])(this,"origin",{}),Object(P["a"])(this,"target",{}),Object(P["a"])(this,"line",{}),Object(P["a"])(this,"type","sequential"),Object(P["a"])(this,"id",""),Object(P["a"])(this,"chances",[]),this.origin=t,this.target=e,this.line=i,this.type=a,this.triangle="",this.chances.push({value:1,chanceType:"on",index:0}),this.line&&this.setLineColor()}setLineColor(){this.line.set({stroke:"sequential"==this.type?"red":"yellow"})}SetID(t){this.id=t,this.line.id=t,console.log(this.line)}get type(){return this.type}get origin(){return this.origin}get target(){return this.target}get length(){let t={x:this.origin.aCoords.tl.x+this.origin.aCoords.br.x/2,y:this.origin.aCoords.br.y+this.origin.aCoords.tl.y/2},e={x:this.target.aCoords.tl.x+this.target.aCoords.br.x/2,y:this.target.aCoords.br.y+this.target.aCoords.tl.y/2};return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}}var F=function(){var t=this,e=t._self._c;return e("div",[e("b-form",{attrs:{id:t.id}},[e("b-form-group",{staticClass:"mb-0",attrs:{label:"Connection Info","label-class":"font-weight-bold pt-0"}},[e("b-form-group",{attrs:{id:"input-group-type",label:"Type","label-for":"input-type","label-size":"sm"}}),e("b-form-select",{attrs:{id:"input-type",size:"sm",options:t.connectionOptions.connectionType},on:{change:t.setLineColor},model:{value:t.connection.type,callback:function(e){t.$set(t.connection,"type",e)},expression:"connection.type"}}),e("p"),"jumping"==t.connection.type?e("div",[e("b-form-group",{attrs:{label:"Chance(s)","label-size":"sm"}},[t._l(t.connection.chances,(function(i){return e("div",{key:i.index},[e("b-card",{attrs:{"no-body":""}},[e("b-list-group",{attrs:{flush:""}},[e("b-list-group-item",[e("b-form-select",{attrs:{id:"input-chance-type",size:"sm",options:t.connectionOptions.chanceType},model:{value:i.chanceType,callback:function(e){t.$set(i,"chanceType",e)},expression:"chance.chanceType"}})],1),e("b-list-group-item",[e("b-form-input",{attrs:{id:"input-chance",type:"number",size:"sm",min:"1",max:"6"},model:{value:i.value,callback:function(e){t.$set(i,"value",e)},expression:"chance.value"}})],1)],1)],1),e("p")],1)})),e("b-button",{attrs:{pill:"",size:"sm"},on:{click:t.addConnection}},[e("b-icon-plus")],1),t._v(" "+t._s(" ")+"\n                    "),e("b-button",{attrs:{pill:"",disabled:t.connection.chances.length<2,size:"sm"},on:{click:function(e){return t.connection.chances.pop()}}},[e("b-icon-dash")],1)],2)],1):t._e(),e("b-form-group",{attrs:{id:"input-group-length",label:"Length","label-for":"input-length","label-size":"sm"}},[e("b-form-input",{attrs:{id:"input-length",size:"sm",disabled:""},model:{value:t.length,callback:function(e){t.length=e},expression:"length"}})],1)],1)],1)],1)},Z=[],G={data(){return{connectionOptions:{connectionType:[{value:"sequential",text:"Sequential"},{value:"jumping",text:"Jumping"}],chanceType:[{value:"on",text:"On"},{value:"over",text:"Over"},{value:"under",text:"Under"},{value:"unless",text:"Unless"}]}}},props:{connection:Object,id:String,embed:Boolean},methods:{setLineColor:function(){this.connection.setLineColor()},addConnection:function(){this.connection.chances.push({value:1,chanceType:"on",index:this.connection.chances.length})}},computed:{title:function(){return this.originName+" → "+this.targetName},originName:function(){return""!=this.connection.origin.space.number?this.connection.origin.space.number.toString():this.connection.origin.space.id},targetName:function(){return""!=this.connection.target.space.number?this.connection.target.space.number.toString():this.connection.target.space.id},length:function(){return this.connection?this.connection.length.toFixed(2)+" px":0}}},K=G,Q=Object(h["a"])(K,F,Z,!1,null,"219cf92c",null),tt=Q.exports,et=function(){var t=this,e=t._self._c;return e("b-sidebar",{attrs:{name:"asidebar",id:"asidebar",width:t.width,title:"Analysis",right:"",shadow:""},on:{shown:t.analyze,hidden:t.reset}},[e("div",{staticStyle:{padding:"10px"}},[e("b-card",{attrs:{id:"preconditions","no-body":"",border:"light"},on:{click:t.reset}},[e("b-card-header",{staticClass:"p-1",attrs:{"header-tag":"header",role:"tab"}},[e("b-button",{directives:[{name:"b-toggle",rawName:"v-b-toggle.preconditions-collapse",modifiers:{"preconditions-collapse":!0}}],attrs:{block:"",variant:t.preconditionsButton}},[t._v("Preconditions")])],1),e("b-collapse",{attrs:{visible:"",id:"preconditions-collapse"}},[e("b-card",{attrs:{"no-body":"","border-variant":t.cardColor,"header-border-variant":t.cardColor}},[e("b-list-group",{attrs:{flush:""}},[e("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t.containsFuridashi?e("b-icon-check-circle",{attrs:{variant:"success"}}):e("b-icon-x-circle",{attrs:{variant:"danger"}}),t._v("\n                            振り出し / Start\n                        ")],1),e("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t.containsAgari?e("b-icon-check-circle",{attrs:{variant:"success"}}):e("b-icon-x-circle",{attrs:{variant:"danger"}}),t._v("\n                            上がり / End\n                        ")],1),e("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t.pathToEndExists?e("b-icon-check-circle",{attrs:{variant:"success"}}):e("b-icon-x-circle",{attrs:{variant:"danger"}}),t._v("\n                            振り出し ➞ 上がり path\n                        ")],1),e("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t.noConflictingChances?e("b-icon-check-circle",{attrs:{variant:"success"}}):e("b-icon-x-circle",{attrs:{variant:"danger"}}),t._v("\n                            No jumping conflicts\n                        ")],1),e("b-list-group-item",{staticClass:"d-flex justify-content-between align-items-center"},[t.noConflictingSequences?e("b-icon-check-circle",{attrs:{variant:"success"}}):e("b-icon-x-circle",{attrs:{variant:"danger"}}),t._v("\n                            No sequential conflicts\n                        ")],1)],1)],1)],1)],1),e("p"),e("b-form",[e("b-form-group",{staticClass:"mb-0",attrs:{label:"Agent-Based Analysis","label-class":"font-weight-bold pt-0"}},[e("b-card",{attrs:{"no-body":""}},[e("b-card-header",{attrs:{header:"Controls"},on:{click:function(e){t.agentControlsVisible=!t.agentControlsVisible}}}),e("b-collapse",{model:{value:t.agentControlsVisible,callback:function(e){t.agentControlsVisible=e},expression:"agentControlsVisible"}},[e("b-card-body",[e("b-form-group",{attrs:{label:"# of Players","label-size":"sm",disabled:!t.readyToAnimate}},[e("b-form-input",{attrs:{size:"sm"},model:{value:t.playerCount,callback:function(e){t.playerCount=e},expression:"playerCount"}})],1),e("b-form-group",{attrs:{label:"Game ends on Agari","label-size":"sm"}},[e("b-form-checkbox",{attrs:{size:"sm",disabled:!t.readyToAnimate},model:{value:t.finishAnimationOnAgari,callback:function(e){t.finishAnimationOnAgari=e},expression:"finishAnimationOnAgari"}})],1),e("b-form-group",{attrs:{label:"Speed","label-size":"sm"}},[e("b-form-input",{attrs:{size:"sm",type:"range",min:"0",max:"1",disabled:!0},model:{value:t.animationSpeed,callback:function(e){t.animationSpeed=e},expression:"animationSpeed"}})],1),t.doneAnimating?e("b-button",{attrs:{block:"",variant:"success",disabled:!t.readyToAnimate},on:{click:t.simulate}},[e("b-icon-play-fill")],1):e("b-button",{attrs:{block:"",variant:"danger"},on:{click:t.reset}},[e("b-icon-x-octagon-fill")],1)],1)],1)],1),e("p"),e("b-form-group",{attrs:{label:"# of Players who reached Agari","label-size":"sm"}},[e("b-form-input",{attrs:{size:"sm",disabled:!0},model:{value:t.onAgari.length,callback:function(e){t.$set(t.onAgari,"length",e)},expression:"onAgari.length"}})],1),e("b-form-group",{attrs:{label:"Rounds until complete","label-size":"sm"}},[e("b-form-input",{attrs:{size:"sm",disabled:!0},model:{value:t.roundsUntilComplete,callback:function(e){t.roundsUntilComplete=e},expression:"roundsUntilComplete"}})],1)],1)],1)],1),e("div",{staticStyle:{padding:"10px"}},[e("b-button",{attrs:{block:"",disabled:!t.readyToAnimate||0==t.heatSpaces.length},on:{click:t.download}},[e("b-icon-file-earmark-arrow-down"),e("em",[t._v(" Download analysis json")])],1)],1)])},it=[];class at{constructor(t,e){Object(P["a"])(this,"spaces",[]),Object(P["a"])(this,"connections",[]),Object(P["a"])(this,"subPaths",[]),this.spaces=t,this.connections=e}findOptimalPath(){}pathString(){let t="";return this.spaces.forEach(e=>t+=e.id+", "),t=t.slice(0,t.length-2),t}connectionsString(){let t="";return this.connections.forEach(e=>{t+=e.origin.id+" ➞ "+e.target.id+", "}),t=t.slice(0,t.length-2),t}}class st{constructor(t,e,i=!1){Object(P["a"])(this,"board",void 0),Object(P["a"])(this,"spaceOn",void 0),Object(P["a"])(this,"path",[]),Object(P["a"])(this,"rolls",[]),Object(P["a"])(this,"toMoveForward",void 0),Object(P["a"])(this,"toMoveBackward",void 0),Object(P["a"])(this,"done",void 0),this.board=e,this.spaceOn=t,this.path.push(t),this.debug=i;while(!this.done)this.roll()}roll(){if(this.done)return;let t=Math.floor(6*Math.random())+1;this.rolls.push(t),this._debug("rolled "+t),this._planMove(t)}_planMove(t){this._debug("planMove "+t+" on "+this.spaceOn.id);let e=this.spaceOn,i=this._findJumpingConnections(this.spaceOn);i.length>0&&i.forEach(i=>{i.chances.forEach(a=>{switch(a.chanceType){case"on":t==a.value&&(e=i.target.space);break;case"over":t>a.value&&(e=i.target.space);break;case"under":t<a.value&&(e=i.target.space);break;case"unless":t!=a.value&&(e=i.target.space);break;default:break}})}),void 0!=e&&(e=this._spaceAhead(t)||e),this._move(e)}_move(t){this._debug("move to "+t.id),this.animated,this.spaceOn=t,this.path.push(this.spaceOn),this.spaceOn.agari&&(this.done=!0)}_spaceAhead(t){this._debug("spaceAhead "+t+" from "+this.spaceOn.id);let e=this.spaceOn;while(t>0){if(e.agari)return e.exact?this._spaceBehind(e,t):e;let i=this._findSequentialConnection(e);if(!i)return!1;e=i.target.space,t--}return e}_spaceBehind(t,e){this._debug("spaceBehind "+e+" from "+t.id);let i=t;while(e>0){if(i.furidashi)return i;let t=this._findReverseConnection(i);i=t.origin.space,e--}return i}_findSequentialConnection(t){this._debug("findSequentialConnection from "+t.id);let e=!1;return this.board.forEach(i=>{i.origin.id==t.id&&"sequential"==i.type&&(e=i)}),e}_findJumpingConnections(t){this._debug("findJumpingConnections");let e=[];return this.board.forEach(i=>{i.origin.id==t.id&&"jumping"==i.type&&e.push(i)}),e}_findReverseConnection(t){this._debug("findReverseConnection from "+t.id);let e={};return this.board.forEach(i=>{i.target.id==t.id&&"sequential"==i.type&&(e=i)}),e}_debug(t){this.debug&&console.log(t)}}var nt={mounted(){Jt.$on("connectionsList",()=>{this.getObjects()}),Jt.$on("createSpace",()=>{this.getObjects()}),Jt.$on("delete",()=>{this.getObjects()})},created(){},data(){return{canvas:{},model:{},Board:[],Spaces:[],Connections:[],players:[],playerShapes:[],turnAt:0,roundAt:0,playerCount:6,finishAnimationOnAgari:!0,animationSpeed:1,onAgari:[],firstOnAgari:[],doneAnimating:!0,heatSpaces:[],preconditionsVisible:!0,agentControlsVisible:!0}},computed:{width(){return"320px"},furidashi(){return this.Spaces.find(t=>t.furidashi)},agari(){return this.Spaces.find(t=>t.agari)},containsFuridashi(){return!!this.furidashi},containsAgari(){return!!this.agari},isJumpingSugoroku(){return!!this.Connections.find(t=>"jumping"==t.type)},paths(){return this.findPaths(this.furidashi)},pathToEndExists(){return!(!this.furidashi||!this.agari)&&0!=this.paths.length},numberOfSpaces(){return this.Spaces.length},noConflictingChances(){return!0},noConflictingSequences(){return!0},isValid(){return!!(this.furidashi&&this.agari&&this.pathToEndExists&&this.noConflictingChances&&this.noConflictingSequences)},cardColor(){return this.isValid?"success":"danger"},preconditionsButton(){return this.isValid?"outline-success":"outline-danger"},heatToAdd(){return 1/this.playerCount*2},readyToAnimate(){return this.isValid&&this.doneAnimating},roundsUntilComplete(){let t=this.onAgari[this.onAgari.length-1];return t?t.path.length:0}},components:{},methods:{getObjects(){let t={};Jt.getObjects(t),this.Board=t.Board,this.Spaces=t.Spaces,this.Connections=t.Connections},getCanvas(){let t={};Jt.getCanvas(t),this.canvas=t.canvas},analyze(){if(this.reset(),this.getObjects(),this.getCanvas(),console.log("analysis\ncontains furidashi: "+this.containsFuridashi+"\ncontains agari: "+this.containsAgari+"\nspaces: "+this.numberOfSpaces+"\npath to end exists: "+this.pathToEndExists),!this.paths)return;let t="non-looping paths ("+this.paths.length+")\n";for(let e=0;e<this.paths.length;e++)t+=e+1+":\t",t+=this.paths[e].pathString()+"\n\t",t+=this.paths[e].connectionsString()+"\n";console.log(t,this.paths)},simulate(){this.reset(),this.doneAnimating=!1,this.isValid&&(this.createHeat(),this.createPlayers(),this.animateNext())},createHeat(){this.canvas.getObjects().forEach(t=>{let e=!1;"ellSpace"==t.type?e=new j["fabric"].EllSpace({rx:t.rx,ry:t.ry}):"rectSpace"==t.type&&(e=new j["fabric"].RectSpace({width:t.width,height:t.height})),e&&(e.heat=0,e.id=t.id,e.left=t.left,e.top=t.top,e.selectable=!1,e.strokeWidth=0,e.opacity=0,e.fill="rgba(0,0,0,0.66)",t.heatSpace=e,this.heatSpaces.push(e),this.canvas.add(e))})},createPlayers(){for(let t=0;t<this.playerCount;t++){let e=new st(this.furidashi,this.Connections);this.players.push(e);let i=new j["fabric"].PlayerShape({id:t+1},e,this.furidashi);this.playerShapes.push(i),this.canvas.add(i)}console.log("players ("+this.playerCount+")",this.players)},animateNext(){if(this.turnAt+=1,this.turnAt>this.playerCount-1){if(this.onAgari.length>0&&(0==this.firstOnAgari.length&&this.onAgari.forEach(t=>this.firstOnAgari.push(t)),this.finishAnimationOnAgari||this.onAgari.length==this.playerCount))return void this.finishAnimation();this.turnAt=0,this.roundAt+=1}let t=this.playerShapes[this.turnAt];if(t)if(t.animationAt>t.path.length-1)this.animateNext();else{let e=t.path[t.animationAt];e.agari&&this.onAgari.push(t),e.shape.heatSpace.opacity+=this.heatToAdd,e.shape.heatSpace.heat+=1,this.animateShape(t,this.animateNext)}},animateShape(t,e){if(t.animationAt>t.path.length-1)return void e();if(0==t.animationAt)return t.animationAt+=1,void e();let i=this.animationSpeed,a=t.findNewPosition();t.animate({left:a.left,top:a.top},{duration:i,onChange:this.canvas.renderAll.bind(this.canvas),onComplete:function(){t.animationAt+=1,e()},easing:j["fabric"].util.ease.easeOutCirc})},finishAnimation(){this.doneAnimating=!0,console.log("players who reached agari in ("+this.firstOnAgari[0].animationAt+") turn(s) ("+this.firstOnAgari.length+")",this.firstOnAgari),console.log(this.roundAt+1+" rounds to completion")},findPaths(t,e=[],i=[],a=[],s=[]){if(!t)return;if(0==e.length&&0==i.length&&(e=[...this.Connections]),i.includes(t)||i.push(t),1==t.agari)return s.push(new at(i,a)),s;let n=[];return e.forEach(e=>{e.origin.id==t.id&&n.push(e)}),n.forEach(n=>{e.splice(e.indexOf(n),1);let o=n.target.space;i.includes(o)?this.findPaths(t,[...e],[...i],[...a],s):(a.push(n),this.findPaths(o,[...e],[...i],[...a],s)),a.pop()}),s},reset(){this.players&&(this.players=[]),this.playerShapes.forEach(t=>{this.canvas.remove(t)}),this.heatSpaces.forEach(t=>{this.canvas.remove(t)}),this.turnAt=0,this.roundAt=0,this.playerShapes=[],this.heatSpaces=[],this.firstOnAgari=[],this.onAgari=[],this.doneAnimating=!0},download(){let t={numberOfSpaces:this.numberOfSpaces,paths:[...this.paths],players:[...this.players],finishedInTurns:this.firstOnAgari[0].animationAt},e=this.Board[0].fileName.split(".").slice(0,-1).join(".")+"analysis.json";console.log(t),t.paths.forEach(t=>{t.connections.forEach(t=>{t.origin=t.origin.id,t.target=t.target.id,t.line.id=t.id,t.line=t.id,t.triangle=null}),t.spaces.forEach(t=>{t.shape=t.shape.id})});let i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});Object(S["saveAs"])(i,e),console.log("downloading "+e+"...")}}},ot=nt,rt=Object(h["a"])(ot,et,it,!1,null,"2c16e2d7",null),lt=rt.exports,ct=i("f5cb"),ht=i.n(ct),dt={data(){return{Board:[],Spaces:[],Connections:[]}},props:{selected:{type:Array}},computed:{analysisToggle(){},topBoard(){return this.Board[this.Board.length-1]},topSpace(){return this.Spaces[this.Spaces.length-1]},topConnection(){return this.Connections[this.Connections.length-1]}},components:{boardList:V,spaceList:q,connectionList:tt,analysis:lt},methods:{jsonUpload:function(t){let e=t.Board[0],i=new $(e.name,this.topBoard.image);for(const a in e)i[a]=e[a];i.image=this.topBoard.image,this.Board=[],this.Board.push(i),Jt.selectBoard(this.Board[0]),this.Spaces=[],t.Spaces.forEach(t=>{let e=new D(t);for(const i in t)e[i]=t[i];this.Spaces.push(e)}),this.Connections=[],t.Connections.forEach(t=>{let e=new W;for(const i in t)e[i]=t[i];this.Connections.push(e)}),Jt.jsonToCanvas({Board:this.Board,Spaces:this.Spaces,Connections:this.Connections,CanvasObjects:t.CanvasObjects})}},mounted(){this.buttonElement=Array.from(document.getElementsByName("sidebarButton")[0])},created(){Jt.$on("createBoard",t=>{let e=this.topBoard;this.Board.push(new $(t.name,t.img));let i=e?e.id+1:1;this.topBoard.id=i,Jt.selectBoard(this.topBoard),console.log("board created: "+this.topBoard.fileName,this.topBoard)}),Jt.$on("createSpace",t=>{let e=this.topSpace;this.Spaces.push(t);let i=e?e.id+1:0;this.topSpace.SetID(i),console.log("space created: ",this.topSpace)}),Jt.$on("delete",t=>{var e=-1;function i(e){return e.id==t.space.id}function a(e){return e.id==t.connection.id}if(t.space){e=this.Spaces.findIndex(i),e>-1&&this.Spaces.splice(e,1);var s=[];if(this.Connections){this.Connections.forEach(e=>{e.origin==t&&(e.origin=null,s.push(e)),e.target==t&&(e.target=null,s.push(e))});for(var n=0;n<s.length;n++)this.Connections.splice(this.Connections.indexOf(s[n]),1),Jt.clearLines()}}t.connection&&(e=this.Connections.findIndex(a),e>-1&&this.Connections.splice(e,1))}),Jt.$on("createConnection",t=>{var e=!1;this.Connections.forEach(i=>{t.origin==i.origin&&t.target==i.target&&(e=!0)}),e||(t.SetID(ht()("connection-")),console.log("connection created: ",t),this.Connections.push(t),Jt.connectionsList(this.Connections))}),Jt.$on("getObjects",t=>{t.Board=this.Board,t.Spaces=this.Spaces,t.Connections=this.Connections}),Jt.$on("download",()=>{let t={Board:this.Board,Spaces:this.Spaces,Connections:this.Connections,CanvasObjects:[]};t.Spaces.forEach(e=>{t.CanvasObjects.push(e.shape),e.shape=e.shape.id}),t.Connections.forEach(e=>{e.origin=e.origin.id,e.target=e.target.id,e.line.id=e.id,t.CanvasObjects.push(e.line),e.line=e.id,e.triangle=null});let e=this.Board[0].fileName.split(".").slice(0,-1).join(".")+".json",i=new Blob([JSON.stringify(t,null,2)],{type:"application/json"});Object(S["saveAs"])(i,e),console.log("downloading "+e+"...")}),Jt.$on("upload",t=>{let e=new FileReader,i=this;e.onload=function(e){let a=JSON.parse(e.target.result);i.jsonUpload(a),console.log("uploaded "+t.name)},e.readAsText(t)}),Jt.$on("submit",()=>{let t=Yt.getImage(),e={Board:this.Board,Spaces:this.Spaces,Connections:this.Connections,CanvasObjects:[]};e.Spaces.forEach(t=>{t.shape&&(t.shape.canvas=null),t.shape=t.shape.id}),e.Connections.forEach(t=>{t.origin=t.origin.id,t.target=t.target.id,t.line&&(t.line.canvas=null,t.line.id=t.id,t.line=t.id,t.triangle=null)});let i=e.Board.englishTitle||this.Board[0].fileName.split(".").slice(0,-1).join("."),a={title:i,board:e.Board,spaces:e.Spaces,connections:e.Connections};E.create(t,a)})}},ut=dt,pt=Object(h["a"])(ut,y,x,!1,null,"4f4dec15",null),gt=pt.exports,bt=function(){var t=this,e=t._self._c;return e("b-sidebar",{attrs:{name:"dbSidebar",id:"dbSidebar",width:t.width,title:"Database",right:"",shadow:""},on:{shown:t.load,hidden:t.reset}},[e("div",{staticStyle:{padding:"10px"}},[e("b-button",{attrs:{block:"",variant:"success"},on:{click:t.submit}},[t._v("Submit")])],1)])},mt=[],ft={mounted(){},created(){},data(){return{}},computed:{width(){return"320px"}},components:{},methods:{load(){},reset(){},submit(){Jt.$emit("submit")}}},vt=ft,wt=(i("294f"),Object(h["a"])(vt,bt,mt,!1,null,"2053ff44",null)),Ct=wt.exports,yt={data(){return{toggled:!1,selected:new Array,board:null,json:null,sidebar:null,sidebarButton:null,jsonButton:null,boardButton:null,dbButton:null,drag:0}},computed:{title:function(){if(this.selected){if(this.selected[0]&&this.selected[0].space)return this.selected[0].space.number?this.selected[0].space.number.toString():this.selected[0].space.id.toString();if(this.selected[0]&&this.selected[0].connection){var t=this.selected[0].connection,e=t.origin.space.number&&""!=t.origin.space.number?t.origin.space.number.toString():t.origin.space.id,i=t.origin.space.number&&""!=t.target.space.number?t.target.space.number.toString():t.target.space.id;return e.toString()+" → "+i}}return this.board?this.board.title:""},width:function(){return 0==!this.drag&&console.log(this.drag),"320px"},nothingSelected:function(){return 0==this.selected.length}},components:{ObjectManager:gt,ImageLoad:C,Analysis:lt,Database:Ct},mounted(){this.jsonButton=document.getElementById("jsonUpload"),this.jsonButton.addEventListener("change",this.uploadJson),this.boardButton=document.getElementById("boardUpload"),this.boardButton.addEventListener("change",this.uploadBoard),this.sidebarButton=Array.from(document.getElementsByName("sidebarButton"))},created(){Jt.$on("mouseShape",t=>{this.mouse=t}),Jt.$on("selectShape",t=>{var e=!1;t.length==this.selected.length&&t.every((t,e)=>t==this.selected[e])&&(e=!0),e||(this.toggled&&!t[0]&&document.getElementsByName("sidebarButton")[0].click(),!this.toggled&&t[0]),e&&!this.toggled&&t[0],this.selected=t}),Jt.$on("selectBoard",t=>{this.board=t}),Jt.$on("deselect",()=>{this.selected=new Array})},methods:{toggle(){},dragged(){},download(){Jt.download()},buttonBoard(){document.getElementById("boardUpload").click()},buttonJson(){document.getElementById("jsonUpload").click()},buttonDb(){},uploadBoard(){},uploadJson(){let t=this.jsonButton.files;0!==t.length&&(this.json=t[0],Jt.upload(this.json))},analysisToggle(){this.toggled&&(this.toggled=!1)},databaseToggle(){this.toggled&&(this.toggled=!1)}}},xt=yt,St=(i("223e"),Object(h["a"])(xt,p,g,!1,null,"30201142",null)),jt=St.exports,Ot=function(){var t=this;t._self._c;return t._m(0)},kt=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"container",position:"relative"}},[e("canvas",{attrs:{id:"c"}})])}];j["fabric"].Connection=j["fabric"].util.createClass(j["fabric"].Line,{type:"connection",async:!0,initialize:function(t,e){e||(e={}),this.callSuper("initialize",t,e),this.set("id",e.id||"")},toObject:function(){return j["fabric"].util.object.extend(this.callSuper("toObject"),{id:this.get("id")})},fromObject:function(t,e){return j["fabric"].Object._fromObject("connection",t,e)},_render:function(t){this.callSuper("_render",t)}}),j["fabric"].RectSpace=j["fabric"].util.createClass(j["fabric"].Rect,{type:"rectSpace",initialize:function(t){t||(t={}),this.callSuper("initialize",t),this.set("label",t.label||""),this.set("id",t.id||"")},toObject:function(){return j["fabric"].util.object.extend(this.callSuper("toObject"),{label:this.get("label"),id:this.get("id")})},fromObject:function(t,e){return j["fabric"].Object._fromObject("rectSpace",t,e)},_render:function(t){this.callSuper("_render",t),t.font="24px Helvetica",t.fillStyle="#333",t.textAlign="center",t.fillText(this.label,0,0)},ChangeLabel:function(t){this.label=t,this.dirty=!0,this.canvas.requestRenderAll()},SetID:function(t){this.id=t},GetID:function(){return this.id},Normalize:function(){let t=this.getObjectScaling();this.width*=t.scaleX,this.height*=t.scaleY,this.scale(1)}}),j["fabric"].EllSpace=j["fabric"].util.createClass(j["fabric"].Ellipse,{type:"ellSpace",initialize:function(t){t||(t={}),this.callSuper("initialize",t),this.set("label",t.label||""),this.set("id",t.id||"")},toObject:function(){return j["fabric"].util.object.extend(this.callSuper("toObject"),{label:this.get("label"),id:this.get("id")})},fromObject:function(t,e){return j["fabric"].Object._fromObject("ellSpace",t,e)},_render:function(t){this.callSuper("_render",t),t.font="24px Helvetica",t.fillStyle="#333",t.textAlign="center",t.fillText(this.label,0,0)},ChangeLabel:function(t){this.label=t,this.dirty=!0,this.canvas.requestRenderAll()},SetID:function(t){this.id=t},GetID:function(){return this.id},Normalize:function(){let t=this.getObjectScaling();this.width*=t.scaleX,this.height*=t.scaleY,this.scale(1)}}),j["fabric"].PlayerShape=j["fabric"].util.createClass(j["fabric"].Ellipse,{type:"playerShape",initialize:function(t,e,i){t||(t={}),this.animationAt=0,this.callSuper("initialize",t),this.selectableselectable=t.selectable||!1,this.fill=t.fill||"#facade",this.stroke=t.stroke||"#ff9999",this.strokeWidth=t.strokeWidth||"2",this.id=t.id||"",this.path=e.path,this.left=t.left||this.findNewPosition().left,this.top=t.top||this.findNewPosition().top;let a=.2*(i.shape.width||i.shape.rx);this.rx=t.rx||a,this.ry=t.ry||a},_render:function(t){this.callSuper("_render",t),t.font="24px Helvetica",t.fillStyle="#333",t.textAlign="center",t.fillText(this.id,0,5)},findNewPosition:function(){let t=this.path[this.animationAt].shape,e=t.width||t.rx,i=t.height||t.ry,a=Math.floor(Math.random()*e*.8)+.1*e,s=Math.floor(Math.random()*i*.8)+.1*i,n={left:t.left+a,top:t.top+s};return n}});class Tt{constructor(t){Object(P["a"])(this,"canvas",[]),this.canvas=t,this.mouseDown(),this.mouseMove(),this.mouseUp()}mouseDown(){let t=this.canvas;t.on("mouse:down",(function(e){if(null==t.activeTool)return;if(null!=e.target)return;let i=t.getPointer(e.e);if(this.isDown=!0,this.selection=!1,this.origX=i.x,this.origY=i.y,"drawRect"==t.activeTool&&(this.shape=new j["fabric"].RectSpace({left:this.origX,top:this.origY,lockScalingFlip:!0,originX:"left",originY:"top",width:i.x-this.origX,height:i.x-this.origY,angle:0,stroke:"red",label:"",fill:"rgba(255,0,0,0.5)",transparentCorners:!1})),"drawEllipse"==t.activeTool&&(this.shape=new j["fabric"].EllSpace({left:this.origX,top:this.origY,lockScalingFlip:!0,originX:"left",originY:"top",rx:i.x-this.origX,ry:i.x-this.origY,angle:0,fill:"rgba(255,0,0,0.5)",stroke:"red",transparentCorners:!1})),"drawLine"==t.activeTool||"drawJump"==t.activeTool){let e=[this.origX,this.origY,i.x,i.y];this.shape=new j["fabric"].Connection(e,{stroke:"drawLine"==t.activeTool?"red":"yellow",strokeWidth:3,selectable:!1,evented:!1})}t.add(this.shape)}))}mouseMove(){let t=this.canvas;t.on("mouse:move",(function(e){if(!this.isDown)return;let i=t.getPointer(e.e);if("drawRect"==t.activeTool||"drawEllipse"==t.activeTool){this.origX>i.x&&this.shape.set({left:Math.abs(i.x)}),this.origY>i.y&&this.shape.set({top:Math.abs(i.y)});let e=Math.abs(this.origX-i.x),a=Math.abs(this.origY-i.y);if(this.shift){let i=e>=a?e:a;"drawRect"==t.activeTool&&this.shape.set({width:i,height:i}),"drawEllipse"==t.activeTool&&this.shape.set({rx:i,ry:i})}else"drawRect"==t.activeTool&&this.shape.set({width:e,height:a}),"drawEllipse"==t.activeTool&&this.shape.set({rx:e,ry:a})}else"drawLine"!=t.activeTool&&"drawJump"!=t.activeTool||this.shape.set({x2:i.x,y2:i.y});t.renderAll()}))}mouseUp(){let t=this.canvas;t.on("mouse:up",(function(e){if(this.isDown=!1,this.shape){let i=t.getObjects(),a=i[i.length-1];if(0==i.length)return;if(t.activeTool,"drawRect"!=t.activeTool&&"drawEllipse"!=t.activeTool||((a.width<=20||a.height<=20)&&(t.remove(a),this.shape=null),this.shape&&!this.shape.space&&(this.shape.space=new D(this.shape),Jt.createSpace(this.shape.space))),"drawLine"==t.activeTool||"drawJump"==t.activeTool)if(this.shape&&!this.shape.connection){let s=t.getPointer(e.e),n=new j["fabric"].Point(this.origX,this.origY),o=new j["fabric"].Point(s.x,s.y),r=null,l=null;if(i.forEach(t=>{t.containsPoint(n,void 0,!0)&&"rgb(0,0,0)"!=t.fill&&(r=t),t.containsPoint(o,void 0,!0)&&"rgb(0,0,0)"!=t.fill&&(l=t)}),r&&l&&r!=l){let e=new W(r,l,this.shape,"drawLine"==t.activeTool?"sequential":"jumping");Jt.createConnection(e)}t.remove(a),this.shape=null}else t.remove(a),this.shape=null}}))}}class At{constructor(t){Object(P["a"])(this,"imageCanvas",[]),this.imageCanvas=t,this._lineMovement(),this._newLines(),this._clearLines()}jsonConnection(t){console.log(t)}_lineMovement(){let t=this;this.imageCanvas.canvas.on("object:moving",(function(){t.imageCanvas.connections&&(t.imageCanvas.connections.forEach(e=>{let i=t._lineCoords(e);e.line.set({x1:i[0].x,y1:i[0].y,x2:i[1].x,y2:i[1].y}),e.triangle.set(t._trianglePosition(e)),t.imageCanvas.canvas.sendToBack(e.triangle),t.imageCanvas.canvas.sendToBack(e.line),t.imageCanvas.canvas.requestRenderAll()}),t.imageCanvas.canvas.board&&t.imageCanvas.canvas.sendToBack(t.imageCanvas.canvas.board))}))}_newLines(){Jt.$on("connectionsList",()=>{this.imageCanvas.connections&&this.imageCanvas.connections.forEach(t=>{t.line&&(this.imageCanvas.canvas.remove(t.line),this.imageCanvas.canvas.remove(t.triangle)),t.line=this._makeLine(t),t.triangle.set(this._trianglePosition(t)),this.imageCanvas.canvas.add(t.line),this.imageCanvas.canvas.add(t.triangle),this.imageCanvas.canvas.sendToBack(t.triangle),this.imageCanvas.canvas.sendToBack(t.line),this.imageCanvas.canvas.sendToBack(this.imageCanvas.canvas.board)})})}_makeLine(t){let e=this._lineCoords(t),i=new j["fabric"].Connection([e[0].x,e[0].y,e[1].x,e[1].y],{stroke:"sequential"==t.type?"red":"yellow",strokeWidth:5,hasControls:!1,selectable:!0,evented:!0,connection:t}),a=new j["fabric"].Triangle({centeredRotation:!0,originX:"center",originY:"center",width:20,height:15,selectable:!1});return t.triangle=a,i}_trianglePosition(t){let e=t.line,i=this._lineCoords(t),a=e.x2-e.x1,s=e.y2-e.y1,n=180*Math.atan2(s,a)/Math.PI+90;return{stroke:e.stroke,fill:e.stroke,left:i[1].x,top:i[1].y,angle:n}}_lineCoords(t){let e=new j["fabric"].Point(t.origin.aCoords.tl.x+t.origin.width/2,t.origin.aCoords.tl.y+t.origin.height/2),i=new j["fabric"].Point(t.target.aCoords.tl.x+t.target.width/2,t.target.aCoords.tl.y+t.target.height/2);return[e,i]}_clearLines(){Jt.$on("clearLines",()=>{if(this.imageCanvas.canvas.getObjects()){var t=this.imageCanvas;t.canvas.getObjects().forEach((function(e){e.connection&&(null!=e.connection.target&&null!=e.connection.origin||t.canvas.remove(e),t.canvas.remove(e.connection.triangle))}))}})}}class Bt{constructor(t,e,i){this.canvas=t,this.img=e;let a=this;j["fabric"].Image.fromURL(this.img.img.src,(function(t){let e=t.set({left:0,top:0,width:a.img.img.width,height:a.img.img.height,scaleX:1,scaleY:1,hasControls:!1,hasBorders:!1,selectable:!1,evented:!1,hoverCursor:"default"});a.canvas.board=e,a.canvas.add(e),a.canvas.sendToBack(e),i()}))}}var zt={data(){return{img:Bt,canvas:j["fabric"].Canvas,connections:null,deselect:[],width:document.documentElement.clientWidth,height:document.documentElement.clientHeight,relativeWidth:1,hasMoved:!1,isPanning:!1,drawShape:Tt,drawConnection:At}},computed:{},components:{},methods:{controlEventBusSetup:function(){Ut.$on("imagePlace",()=>{void 0!=this.img.img&&this.canvasCenter()}),Ut.$on("imagePanPress",()=>{this.isPanning=!0}),Ut.$on("imagePanRelease",()=>{this.isPanning=!1}),Ut.$on("drawRect",()=>{this.controlSetActive("drawRect")}),Ut.$on("drawEllipse",()=>{this.controlSetActive("drawEllipse")}),Ut.$on("drawPolygon",()=>{}),Ut.$on("drawLine",()=>{this.controlSetActive("drawLine")}),Ut.$on("drawJump",()=>{this.controlSetActive("drawJump")}),Ut.$on("drawSelect",()=>{this.controlSetActive(null)}),Ut.$on("shiftPress",()=>{this.canvas.shift=!0}),Ut.$on("backspace",()=>{if(this.canvas.getActiveObjects()){var t=this;this.canvas.getActiveObjects().forEach((function(e){t.canvas.remove(e),Jt.delete(e)}))}}),Ut.$on("shiftRelease",()=>{this.canvas.shift=!1})},fileEventBusSetup:function(){Yt.$on("imageLoaded",t=>{this.imageSetup(t)})},objectEventBusSetup:function(){Jt.$on("connectionsList",t=>{this.connections=t}),Jt.$on("jsonToCanvas",t=>{t.CanvasObjects.forEach(e=>{let i={};if("ellSpace"==e.type)i=new j["fabric"].EllSpace(e);else{if("rectSpace"!=e.type)return;i=new j["fabric"].RectSpace(e)}let a=t.Spaces.find(t=>t.id==i.id);a.shape=i,i.space=a,this.canvas.add(i)}),t.Connections.forEach(e=>{let i=t.Spaces.find(t=>t.id==e.origin).shape;e.origin=i;let a=t.Spaces.find(t=>t.id==e.target).shape;e.target=a}),Jt.connectionsList(t.Connections)}),Jt.$on("getCanvas",t=>{t.imageCanvas=this,t.canvas=this.canvas})},canvasSetup:function(){this.canvas=new j["fabric"].Canvas("c",{selection:!1,backgroundColor:"#facade",shift:!1,preserveObjectStacking:!0,width:document.documentElement.clientWidth*this.relativeWidth,height:document.documentElement.clientHeight}),this.canvasPanSetup(),this.$nextTick(()=>{this.canvas.renderAll()})},canvasResize:function(){this.width=document.documentElement.clientWidth*this.relativeWidth,this.height=document.documentElement.clientHeight,this.canvas.setWidth(this.width),this.canvas.setHeight(this.height),this.canvas.calcOffset(),this.$nextTick(()=>{this.canvas.renderAll(),this.hasMoved||void 0==this.img.img||this.canvasCenter()})},canvasCenter:function(){this.hasMoved=!1,this.canvas.setZoom(1);var t=this.img.img.img,e=document.documentElement.clientWidth,i=document.documentElement.clientHeight,a=Math.max(t.width,t.height),s=Math.max(e,i),n=.75,o=s/a*n,r=this.width/o,l=this.height/o,c=t.x-r/2+t.width/2,h=t.y-l/2+t.height/2;this.canvas.absolutePan({x:c,y:h}),this.canvas.setZoom(o)},imageSetup:function(t){this.img=new Bt(this.canvas,t,this.canvasCenter)},controlSetup:function(){this.drawShape=new Tt(this.canvas),this.drawConnection=new At(this)},canvasSelectSetup:function(){this.canvas.on("mouse:up",(function(){var t=this.getActiveObjects();t[0]?Jt.selectShape(this.getActiveObjects()):Jt.deselect()}))},canvasZoomSetup:function(){var t=this;this.canvas.on("mouse:wheel",(function(e){t.hasMoved=!0;var i=e.e.deltaY,a=this.getZoom();a*=.999**(3*i),a<.1&&(a=.1),a>20&&(a=20),this.zoomToPoint({x:e.e.offsetX,y:e.e.offsetY},a),e.e.preventDefault(),e.e.stopPropagation()}))},canvasPanSetup:function(){var t=this;this.canvas.on("mouse:down",(function(e){var i=e.e;t.isPanning&&(this.isDragging=!0,this.selection=!1,this.lastPosX=i.clientX,this.lastPosY=i.clientY)})),this.canvas.on("mouse:move",(function(e){if(this.isDragging){t.hasMoved=!0;var i=e.e,a=this.viewportTransform;a[4]+=i.clientX-this.lastPosX,a[5]+=i.clientY-this.lastPosY,this.requestRenderAll(),this.lastPosX=i.clientX,this.lastPosY=i.clientY}})),this.canvas.on("mouse:up",(function(){this.setViewportTransform(this.viewportTransform),this.isDragging=!1,this.selection=!0}))},controlSetActive:function(t){1!=this.canvas.isDown&&(this.canvas.activeTool=t,this.setSelectable(),console.log("activeTool: "+this.canvas.activeTool))},setSelectable:function(){"drawLine"!=this.canvas.activeTool&&"drawJump"!=this.canvas.activeTool||0!=this.deselect.length?"drawLine"!=this.canvas.activeTool&&"drawJump"!=this.canvas.activeTool&&this.deselect.length>0&&(this.canvas.getObjects().forEach(t=>{t.space&&this.deselect.includes(t.space.id)&&(t.selectable=!0,t.evented=!0)}),this.deselect=[],this.canvas.selection=!0):(this.canvas.discardActiveObject(),this.canvas.getObjects().forEach(t=>{t.selectable&&t.evented&&void 0!=t.space&&(t.selectable=!1,t.evented=!1,this.deselect.push(t.space.id))}),this.canvas.selection=!1)}},created(){this.controlEventBusSetup(),this.fileEventBusSetup(),this.objectEventBusSetup()},mounted(){this.canvasSetup(),this.canvasSelectSetup(),this.canvasZoomSetup(),this.controlSetup(),window.addEventListener("resize",this.canvasResize)}},_t=zt,Et=Object(h["a"])(_t,Ot,kt,!1,null,"3b16ca50",null),Pt=Et.exports;class $t{constructor(){document.addEventListener("keydown",t=>{switch(t.target.tagName){case"INPUT":case"SELECT":case"TEXTAREA":return}const e=t.key;switch(e){case" ":Ut.imagePanPress();break;case"Shift":Ut.shiftPress();break;default:return}},!1),document.addEventListener("keyup",t=>{switch(t.target.tagName){case"INPUT":case"SELECT":case"TEXTAREA":return}const e=t.key;switch(e){case"c":Ut.imagePlace();break;case"r":Ut.drawRect();break;case"e":Ut.drawEllipse();break;case"p":Ut.drawPolygon();break;case"m":Ut.drawSelect();break;case"l":Ut.drawLine();break;case" ":Ut.imagePanRelease();break;case"Shift":Ut.shiftRelease();break;case"d":Ut.backspace();break;case"j":Ut.drawJump();break;default:return}},!1)}}new $t;var Lt={name:"sugorokuapp",data(){return{debug:!0}},components:{appToolbar:u,appSidebar:jt,appImageCanvas:Pt}},Mt=Lt,Nt=(i("9331"),Object(h["a"])(Mt,s,n,!1,null,null,null)),Rt=Nt.exports,It=i("8c4f");a["default"].use(It["a"]);var Vt=new It["a"]({mode:"history",routes:[{path:"/",alias:"/sugoroku",name:"sugoroku",component:()=>i.e("chunk-2d229bd2").then(i.bind(null,"df71"))},{path:"/add",name:"add",component:()=>i.e("chunk-2d0d5fe0").then(i.bind(null,"713c"))}]}),Dt=i("5f5b"),Ht=i("b1e0");i("f9e3"),i("2dd8");a["default"].config.productionTip=!1;const Jt=new a["default"]({methods:{createBoard(t){this.$emit("createBoard",t)},selectBoard(t){this.$emit("selectBoard",t)},createSpace(t){this.$emit("createSpace",t)},delete(t){this.$emit("delete",t),this.deselect()},clearLines(){this.$emit("clearLines")},createConnection(t){this.$emit("createConnection",t)},connectionsList(t){this.$emit("connectionsList",t)},selectShape(t){this.$emit("selectShape",t)},deselect(){this.$emit("deselect")},download(){this.$emit("download")},upload(t){this.$emit("upload",t)},submit(){this.$emit("submit")},jsonToCanvas(t){this.$emit("jsonToCanvas",t)},getObjects(t){this.$emit("getObjects",t)},getCanvas(t){this.$emit("getCanvas",t)}}}),Ut=new a["default"]({methods:{drawRect(){this.$emit("drawRect")},drawEllipse(){this.$emit("drawEllipse")},drawPolygon(){this.$emit("drawPolygon")},drawSelect(){this.$emit("drawSelect")},drawLine(){this.$emit("drawLine")},drawJump(){this.$emit("drawJump")},imagePlace(){this.$emit("imagePlace")},imagePanPress(){this.$emit("imagePanPress")},imagePanRelease(){this.$emit("imagePanRelease")},shiftPress(){this.$emit("shiftPress")},shiftRelease(){this.$emit("shiftRelease")},backspace(){this.$emit("backspace")}}}),Yt=new a["default"]({props:{img:{}},methods:{imageLoaded(t){this.img=t,this.$emit("imageLoaded",t)},getImage(){return this.img}}});a["default"].use(Dt["a"]),a["default"].use(Ht["a"]),new a["default"]({router:Vt,el:"#app",render:t=>t(Rt)})},"6bd7":function(t,e,i){},"72a2":function(t,e,i){},"79b5":function(t,e,i){},9331:function(t,e,i){"use strict";i("72a2")},d50a:function(t,e,i){"use strict";i("79b5")},e95d:function(t,e,i){}});
//# sourceMappingURL=app.daf1d33c.js.map